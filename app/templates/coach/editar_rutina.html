<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Editar Rutina</title>
<style>
     body { background:#0f0f0f; color:#e6e6e6; font-family:Arial; padding:30px; }
     .card { background:#1a1a1a; padding:20px; border-radius:12px; border:1px solid #333; max-width:600px; margin:auto; }
     input, textarea { width:100%; padding:10px; margin-top:10px; border-radius:8px; border:1px solid #333; background:#0f0f0f; color:white; }
     button { margin-top:15px; padding:10px; width:100%; background:#00d4ff; border:none; border-radius:8px; font-weight:bold; }
     .ejercicio { background:#111; padding:10px; border-radius:8px; margin-top:10px; border:1px solid #333; }

     /* Caja de sugerencias */
     .sugerencias {
        background:#1a1a1a;
        border:1px solid #333;
        border-radius:8px;
        margin-top:5px;
        display:none;
        position:absolute;
        width:100%;
        z-index:20;
     }
     .sugerencias div {
        padding:10px;
        cursor:pointer;
     }
     .sugerencias div:hover {
        background:#00d4ff;
        color:black;
     }
</style>
</head>

<body>
<div class="card">
    <h2>Agregar ejercicios</h2>

    <form method="POST">
        
        <label>Día</label>
        <select name="dia">
            <option value="Lunes">Lunes</option>
            <option value="Martes">Martes</option>
            <option value="Miércoles">Miércoles</option>
            <option value="Jueves">Jueves</option>
            <option value="Viernes">Viernes</option>
            <option value="Sábado">Sábado</option>
            <option value="Domingo">Domingo</option>
        </select>

        <label>Nombre del ejercicio</label>
        <input type="text" id="nombre" name="nombre" autocomplete="off" required>

        <!-- Caja de sugerencias -->
         <div id="sugerencias" class="sugerencias"></div>

        <label>Series</label>
        <input type="number" name="series">

        <label>Repeticiones</label>
        <input type="text" name="repeticiones">

        <label>Peso sugerido</label>
        <input type="text" name="peso">

        <label>Notas</label>
        <textarea name="notas"></textarea>

        <button type="submit">Agregar ejercicio</button>
    </form>

    <h3>Ejercicios agregados</h3>

    {% for e in ejercicios %}
    <div class="ejercicio">
        <strong>{{ e[3] }}</strong> — {{ e[4] }} series, {{ e[5] }} reps
        <br>Día: {{ e[2] }}
        <br>Peso: {{ e[6] }}
        <br>{{ e[7] }}
    </div>
    {% endfor %}
</div>

<script>
const input = document.getElementById("nombre");
const box = document.getElementById("sugerencias");

input.addEventListener("input", async () => {
    const q = input.value.trim();

    if (q.length < 2) {
        box.style.display = "none";
        return;
    }

    const res = await fetch(`/buscar_ejercicios?q=${q}`);
    const data = await res.json();

    box.innerHTML = "";

    if (data.resultados.length === 0) {
        box.style.display = "none";
        return;
    }

    data.resultados.forEach(ej => {
        const div = document.createElement("div");
        div.textContent = ej;
        div.onclick = () => {
            input.value = ej;
            box.style.display = "none";
        };
        box.appendChild(div);
    });

    box.style.display = "block";
});
</script>

</body>
</html>